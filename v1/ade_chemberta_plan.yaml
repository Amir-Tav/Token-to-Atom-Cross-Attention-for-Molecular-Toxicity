#
#  ADE-ChemBERTa Project Roadmap  –  v1.0
#  Save as: ade_chemberta_plan.yaml
#  -------------------------------------------------
#  Edit ONLY the right-hand values; keep the keys.
#

meta:
  author: "<your name>"
  created: "2025-07-13"
  description: "End-to-end pipeline: ChemBERTa ➜ SHAP ➜ Meta-Explanation MLP for 3 ADE labels"

data:
  raw_csvs:
    train: "data/raw/train.csv"
    val:   "data/raw/val.csv"
    test:  "data/raw/test.csv"
  columns_keep:
    smiles: "smiles"
    labels:
      - "label_Gastrointestinal disorders"
      - "label_Infections and infestations"
      - "label_Nervous system disorders"
  split:
    method: "Bemis–Murcko scaffold"
    ratios: {train: 0.70, val: 0.15, test: 0.15}
    file: "data/interim/ade_3lbl.csv"

tensors:
  max_len: 128
  outputs:
    X_train: "data/processed/X_train.npy"
    y_train: "data/processed/y_train.npy"
    X_val:   "data/processed/X_val.npy"
    y_val:   "data/processed/y_val.npy"
    X_test:  "data/processed/X_test.npy"
    y_test:  "data/processed/y_test.npy"

model:
  backbone: "seyonec/ChemBERTa-zinc-250k-pubchem-1m"
  head_out_dim: 3
  loss: "BCEWithLogitsLoss"
  pos_weight: "inverse_label_freq"
  metrics: ["per-label F1", "none-positive accuracy"]
  save_dir: "models/chemberta_3lbl"

thresholds:
  search_range: [0.05, 0.5]
  criterion: "balanced_accuracy"
  output_file: "models/chemberta_3lbl/thresholds.json"

shap:
  explainer: "DeepExplainer"
  background_size: 100
  caches:
    train: "data/shap/shap_train.npz"
    val:   "data/shap/shap_val.npz"
    test:  "data/shap/shap_test.npz"

meta_mlp:
  top_k_groups_per_label: 5
  input_dim: 15          # 3 labels × k groups
  hidden_dim: 512
  dropout: 0.2
  explanation_classes_file: "config/excl_vocabulary.json"
  model_file: "models/meta_mlp.pt"

ui:
  framework: "Streamlit"
  features:
    - "SMILES input"
    - "Probabilities + binary decisions"
    - "Colour-graded token heatmaps"
    - "Justification sentences"
    - "Download JSON button"

ops:
  tracking: "Weights & Biases"
  drift_monitor: "Tanimoto distance"
  retrain_cycle: "monthly"
